const e=document.getElementById("body"),t=(document.getElementById("header"),document.getElementById("login")),n=document.getElementById("form"),o=document.getElementById("username"),s=document.getElementById("password"),a=document.getElementById("image-selection"),r=document.getElementById("create-account-button"),c=document.getElementById("log-in-button"),l=document.getElementById("logged-in-users"),d="https://slutprojekt-social-media-default-rtdb.europe-west1.firebasedatabase.app/",i=document.createElement("p"),u=document.createElement("h1"),m=document.createElement("h1"),y=document.createElement("input"),h=document.createElement("li"),p=document.createElement("h2");e.appendChild(p);const g=document.createElement("div");document.body.appendChild(g);async function w(e){await E();const t=`${d}users/${e.userName}.json`,n={method:"PUT",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}};try{const e=await fetch(t,n);if(!e.ok)throw new Error(`Error: ${e.status} ${e.statusText}`)}catch(e){throw console.log(e),new Error("Failed to save user information.")}}async function E(){try{const e=await fetch(`${d}users.json`);if(!e.ok)throw new Error(`Error: ${e.status} ${e.statusText}`);const t=await e.json();if(!t)return[];return Object.values(t)}catch(e){throw new Error("Failed to fetch users")}}function f(n){let o=[];Object.values(n).forEach((e=>o.push(e)));let s=o.sort(((e,t)=>new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()));l?(l.innerHTML="",s.forEach(((n,o)=>{Object.values(n.status).forEach((o=>{if(!n.newUser){const s=document.createElement("li");s.textContent=`${n.userName}s Status: ${o}`,l.appendChild(s),e.style.backgroundColor="#ccc";const a=document.createElement("img");a.src=n.imageurl,a.style.width="50px",a.style.height="50px",a.style.borderRadius="5rem",s.appendChild(a),s.addEventListener("click",(()=>{console.log(n),document.body.innerHTML="",t.style.display="none";const o=document.createElement("div");o.innerHTML=`<h2>Welcome to ${n.userName}'s page! </br> Status: ${Object.values(n.status)}</h2>`,document.body.appendChild(o),e.style.backgroundColor="yellow",e.style.color="#333",e.style.textAlign="center";const s=document.createElement("img");s.src=n.imageurl,s.style.width="90px",s.style.height="90px",s.style.borderRadius="5rem",o.appendChild(s);const a=document.createElement("button");a.textContent="Log Out",a.style.textAlign="center",a.style.backgroundColor="#333",a.style.color="white",a.style.padding="10px",a.style.margin="10px",document.body.appendChild(a),a.addEventListener("click",(function(){window.location.href="./index.html"}))}))}}))}))):console.error("Logged-in users list not found.")}a?a.addEventListener("change",(()=>{const e=a.value;a.value=e})):console.error("Image element not found."),r&&o&&s?r.addEventListener("click",(async()=>{u.textContent=" ",i.innerText=" ";const e=o.value,t=s.value;if(!e||!t)return i.textContent="Username and / or password cannot be empty.",i.style.color="red",void r.insertAdjacentElement("afterend",i);if(!await async function(e){return!(await E()).some((t=>t.userName===e))}(e))return i.textContent="Username is already taken. Please choose another one.",i.style.color="red",void r.insertAdjacentElement("afterend",i);p.textContent="Your account has been successfully created! Now  you can log in with your new account.",p.style.color="green";const n={userName:e,password:t,status:"",imageurl:a?.value??"",newUser:!0,createdAt:(new Date).toISOString()};await w(n)})):console.error("Cant finnd one or more elements"),c&&o&&s?c.addEventListener("click",(async e=>{e.preventDefault(),p.textContent=" ",u.textContent=" ",document.body.style.alignContent="center",i.textContent=" ";const a=s.value,r=(await E()).find((e=>e.userName===o.value));if(i.textContent="The account has been Successfully logged in! ",!r)return i.textContent="There is no account found for this user. Please create an account first.",i.style.color="red",void n?.appendChild(i);if(r.password!==a)return i.textContent="Incorrect password. Please try again.",i.style.color="red",void n?.appendChild(i);r.newUser=!1,await w(r),f(await E()),g.innerHTML=`<h1>Welcome ${o.value}!</h1> `,t.style.display="none";const c=document.createElement("img");c.src=r.imageurl,c.style.width="200px",c.style.height="30%",c.style.borderRadius="5rem",g.appendChild(c),g.style.textAlign="center";const C=document.createElement("p");g.appendChild(C),C.textContent=" Write your status here:",g.appendChild(y),g.appendChild(l),l.style.display="block",y.style.display="block",y.value="",y.id="status",y.classList.add("status-input");const x=document.createElement("button");x.innerText="Post Status",g.appendChild(x),x.classList.add("post-status-button"),x.addEventListener("click",(async()=>{const e=y.value,t=`${d}users/${r.userName}/status.json`,n={method:"POST",body:JSON.stringify(e),headers:{"Content-type":"application/json; charset=UTF-8"}};try{const e=await fetch(t,n);if(!e.ok)throw new Error(`Error: ${e.status} ${e.statusText}`)}catch(e){throw console.log(e),new Error("Failed to save user information.")}f(await E()),y.value=""}));const b=document.createElement("button");b.innerText="Delete User",b.style.textAlign="center",b.style.backgroundColor="rgb(203, 58, 58)",b.style.margin="10px",b.style.padding="10px",g.appendChild(b),b?.addEventListener("click",(async e=>{e?.preventDefault(),h.textContent=" ",o?(await async function(e){console.log("Deleting user");const t=`${d}users/${e}.json`,n={method:"DELETE",headers:{"Content-type":"application/json; charset=UTF-8"}};try{const e=await fetch(t,n);if(!e.ok)throw new Error(`Error: ${e.status} ${e.statusText}`);console.log("User deleted successfully"),u.textContent="This users account has been successfully deleted!",document.body.appendChild(u),f(await E()),window.location.href="./index.html"}catch(e){throw console.log(e),m.textContent="Failed to delete user. Please try again.",document.body.appendChild(m),new Error("Failed to delete user")}}(o.value),i.textContent=" "):console.error("Username input element not found.")}));const v=document.createElement("button");v.textContent="Log Out",v.classList.add("logout-button"),g.appendChild(v),v.addEventListener("click",(function(){window.location.href="./index.html"}))})):console.error("No element/elements found");
//# sourceMappingURL=index.9f0c27c4.js.map
